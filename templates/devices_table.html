<div id="devices-table" hx-target="this">
  <div class="flex items-center justify-between px-4 pt-4 pb-3">
    <div>
      <p class="text-sm text-slate-400">Showing up to {{ limit }} most recent devices.</p>
    </div>
  </div>
  <div class="overflow-x-auto">
    <table class="min-w-full divide-y divide-slate-800">
      <thead class="bg-slate-900/80">
        <tr class="text-left text-xs uppercase tracking-wide text-slate-400">
          <th class="px-4 py-3">Name</th>
          <th class="px-4 py-3">Device</th>
          <th class="px-4 py-3">MAC</th>
          <th class="px-4 py-3">IP</th>
          <th class="px-4 py-3">Vendor</th>
          <th class="px-4 py-3">Last seen</th>
          <th class="px-4 py-3">Services</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-slate-800">
        {% for d in devices %}
        {% set name = d.friendly_name or d.display_name or d.mdns_name or d.device_name or d.mac %}
        <tr class="hover:bg-slate-800/50">
          <td class="px-4 py-3">
            <div class="text-sm font-semibold text-slate-50">{{ name }}</div>
            {% if d.mdns_name and d.mdns_name != name %}
            <div class="text-xs text-slate-400">mDNS: {{ d.mdns_name }}</div>
            {% endif %}
          </td>
          <td class="px-4 py-3">
            <div class="text-sm text-slate-100">{{ d.device_name or "—" }}</div>
            {% if d.mdns_txt.model %}
            <div class="text-xs text-slate-400">Model: {{ d.mdns_txt.model }}</div>
            {% endif %}
          </td>
          <td class="px-4 py-3 text-sm font-mono text-slate-200">{{ d.mac or "—" }}</td>
          <td class="px-4 py-3">
            <div class="text-sm font-mono text-slate-200">{{ d.last_ip or "—" }}</div>
            {% if d.last_hostname %}
            <div class="text-xs text-slate-400">{{ d.last_hostname }}</div>
            {% endif %}
          </td>
          <td class="px-4 py-3 text-sm text-slate-200">{{ d.vendor or "—" }}</td>
          <td class="px-4 py-3 text-sm text-slate-200">{{ d.last_seen or "—" }}</td>
          <td class="px-4 py-3">
            <div class="flex flex-wrap gap-1">
              {% for st in d.mdns_service_types or [] %}
              <span class="rounded-full bg-slate-800 px-2 py-1 text-xs text-slate-200">{{ st }}</span>
              {% endfor %}
            </div>
          </td>
        </tr>
        {% endfor %}
        {% if devices|length == 0 %}
        <tr>
          <td colspan="7" class="px-4 py-6 text-center text-slate-400 text-sm">
            No devices yet. Run a scan to populate inventory.
          </td>
        </tr>
        {% endif %}
      </tbody>
    </table>
  </div>
</div>
